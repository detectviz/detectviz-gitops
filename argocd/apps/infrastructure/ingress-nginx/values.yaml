# Ingress-Nginx Configuration for L7 Load Balancing
# 根據 README.md 架構，Ingress Controller 部署到 app-worker 節點
# 使用 hostPort 而非 LoadBalancer Service，因為 MetalLB 會處理外部流量
ingress-nginx:
  controller:
    kind: Deployment
    # 強制部署到 app-worker 節點以符合架構設計
    nodeSelector:
      node-role.kubernetes.io/workload-apps: "true"
    # 禁用 Service，因為我們使用 hostPort 直接暴露埠
    service:
      enabled: false
    # 使用 hostPort 在 app-worker 節點上直接暴露 80/443 埠
    # 這樣 MetalLB 就不需要介入，流量直接到達節點
    hostPort:
      enabled: true
      ports:
        http: 80
        https: 443
